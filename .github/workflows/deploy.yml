name: Deploy to server

on:
    push:
        branches: ["master"]

jobs:
    deploy:
        runs-on: ubuntu-latest
        steps:
            - name: ssh Deploy
              uses: appleboy/ssh-action@master
              with:
                  host: ${{ secrets.HOST }}
                  username: ${{ secrets.USERNAME }}
                  key: ${{ secrets.SSH_KEY }}
                  script: |
                      cd /var/www/YouConf

                      git checkout master
                      git pull origin master

                      composer install --optimize-autoloader

                      npm install
                      npm run build

                      php artisan migrate --force
